{{ 'cart-drawer.css' | asset_url | stylesheet_tag }}

<div>
  <div class="cart-drawer__wrapper" data-ajax-cart-section>
    <div class="cart-drawer__header">
      <h2>Cart ({{ cart.item_count }})</h2>
    </div>

    <div class="cart-drawer__items" data-ajax-cart-section-scroll>
      {% for line_item in cart.items %}
        {% assign line_item_index = forloop.index %}

        <div class="cart-drawer__item">
          <div class="cart-item__media">
            {{ line_item.product | image_url: width: 200 | image_tag }}
          </div>
          <div class="cart-item__details">
            <div class="cart-item__heading">
              <a href="{{ line_item.url }}">
                {{ line_item.title | escape }}
              </a>

              {% if line_item.original_price > line_item.final_price %}
                <s>{{ line_item.original_price | money }}</s>
              {% endif %}

              <div>{{ line_item.final_price | money }}</div>
              {% if line_item.line_level_discount_allocations.size > 0 %}
                Discounts:
                <ul>
                  {% for discount_allocation in line_item.line_level_discount_allocations %}
                    <li>{{ discount_allocation.discount_application.title }}-{{ discount_allocation.amount | money }}</li>
                  {% endfor %}
                </ul>
              {% endif %}
            </div>
            <div class="cart-item__action">
              <ajax-cart-quantity>
                <a
                  data-ajax-cart-quantity-minus
                  href="{{ routes.cart_change_url }}?line={{ line_item_index }}&quantity={{ line_item.quantity | minus: 1 }}"
                >
                  {{- 'icon-minus.svg' | inline_asset_content -}}
                </a>

                <input
                  data-ajax-cart-quantity-input="{{ line_item_index }}"
                  name="updates[]"
                  value="{{ line_item.quantity }}"
                  type="number"
                  form="my-ajax-cart-form"
                >

                <a
                  data-ajax-cart-quantity-plus
                  href="{{ routes.cart_change_url }}?line={{ line_item_index }}&quantity={{ line_item.quantity | plus: 1 }}"
                >
                  {{- 'icon-plus.svg' | inline_asset_content -}}
                </a>
              </ajax-cart-quantity>

              <div class="cart-item__remove">
                {{- 'icon-close.svg' | inline_asset_content -}}
                <a href="{{ line_item.url_to_remove }}" data-ajax-cart-request-button>Remove</a>
              </div>
            </div>
            <div>
              {%- if line_item.original_line_price != line_item.final_line_price -%}
                <div>
                  <s>
                    {{ line_item.original_line_price | money }}
                  </s>
                  <span>
                    {{ line_item.final_line_price | money }}
                  </span>
                </div>
              {%- else -%}
                <span>
                  {{ line_item.original_line_price | money }}
                </span>
              {%- endif -%}
            </div>
            <div data-ajax-cart-errors="{{ line_item.key }}"></div>
          </div>
        </div>
      {% endfor %}
    </div>
    <div>
      Subtotal: {{ cart.items_subtotal_price | money }}
      {% if cart.cart_level_discount_applications.size > 0 %}
        Discounts:

        <ul>
          {% for discount_application in cart.cart_level_discount_applications %}
            <li>{{ discount_application.title }}-{{ discount_application.total_allocated_amount | money }}</li>
          {% endfor %}
        </ul>
      {% endif %}

      Total: {{ cart.total_price | money }}
    </div>
    <div class="cart-drawer__footer">
      {% form 'cart', cart, id: 'my-ajax-cart-form' %}
        <button type="submit" name="checkout">Checkout â€” {{ cart.total_price | money_with_currency }}</button>
      {% endform %}
    </div>
  </div>
</div>

{% schema %}
{
  "name": "t:sections.main-cart-items.name",
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:sections.all.colors.label",
      "default": "scheme-1"
    },
    {
      "type": "header",
      "content": "t:sections.all.padding.section_padding_heading"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_top",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_bottom",
      "default": 36
    }
  ]
}
{% endschema %}
