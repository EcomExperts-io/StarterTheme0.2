{% comment %}
  Renders a product card

  Accepts:
  - card_product: {Object} Product Liquid object (optional)
  - media_aspect_ratio: {String} Size of the product image card. Values are "square" and "portrait". Default is "square" (optional)
  - image_shape: {String} Image mask to apply to the product image card. Values are "arch", "blob", "chevronleft", "chevronright", "diamond", "parallelogram", and "round". (optional)
  - show_secondary_image: {Boolean} Show the secondary image on hover. Default: false (optional)
  - show_vendor: {Boolean} Show the product vendor. Default: false
  - show_rating: {Boolean} Show the product rating. Default: false
  - extend_height: {Boolean} Card height extends to available container space. Default: true (optional)
  - lazy_load: {Boolean} Image should be lazy loaded. Default: true (optional)
  - skip_styles: {Boolean} Don't include component styles. Useful when rendering multiple product cards in a loop. Default: false (optional)
  - quick_add: {Boolean} Show the quick add button.
  - section_id: {String} The ID of the section that contains this card.
  - horizontal_class: {Boolean} Add a card--horizontal class if set to true. Default: false (optional)
  - horizontal_quick_add: {Boolean} Changes the quick add button styles when set to true. Default: false (optional)
  - placeholder_image: {String} The placeholder image to use when no product exists. Default: 'product-apparel-2' (optional)

  Usage:
  {% render 'card-product', show_vendor: section.settings.show_vendor %}
{% endcomment %}
<div class="product-card" data-product-id="{{ card_product.id }}">
  <a href="/products/{{ card_product.handle }}">
    <img
      src="{{ card_product.featured_image | image_url: width: 533 }}"
      alt="{{ card_product.title }}"
      class="product-image"
      width="{{ card_product.featured_image.width }}"
      height="{{ card_product.featured_image.height }}"
      data-product-image="{{ card_product.id }}"
    >
  </a>
  {% if show_vendor %}
    <div class="product-brand">{{ card_product.vendor }}</div>
  {% endif %}

  <div class="product-name">{{ card_product.title }}</div>
  <div class="color-swatches">
    {%- for option in card_product.options_with_values -%}
      {%- if option.name == section.settings.variant_option_name -%}
        {%- for value in option.values -%}
          {%- for variant in card_product.variants -%}
            {%- if variant.options contains value and variant.featured_image != blank -%}
              <span
                class="color-swatch"
                style="background-image: url('{{ variant.featured_image | default: card_product.featured_image | image_url: width: 50 }}'); background-size: cover; background-position: center;"
                title="{{ value }}"
                data-variant-id="{{ variant.id }}"
                data-variant-image="{{ variant.featured_image | default: card_product.featured_image | image_url: width: 533 }}"
                data-swatch-color="{{ value | handleize }}"
                data-swatch
              ></span>
              {%- break -%}
            {%- endif -%}
          {%- endfor -%}
        {%- endfor -%}
      {%- endif -%}
    {%- endfor -%}
  </div>
  <div class="product-price">
    <span class="product-original-price">{{ card_product.price_max | money }}</span>
    {{ card_product.compare_at_price | money }}
  </div>
</div>

<style>
  .color-swatches {
    display: flex;
    gap: 5px;
    margin: 8px 0;
  }
  .color-swatch {
    width: 30px;
    height: 30px;
    border-radius: 50%;
    border: 1px solid #ddd;
    cursor: pointer;
    transition: transform 0.2s ease;
  }
  .color-swatch.selected {
    border: 2px solid #000;
    transform: scale(1.1);
  }
  .color-swatch:hover {
    transform: scale(1.1);
    border-color: #000;
  }
  .swatch-disabled {
    opacity: 0.5;
    cursor: not-allowed;
    text-decoration: line-through;
  }
</style>
