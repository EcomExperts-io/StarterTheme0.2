{%- style -%}
  .filters-sidebar {
    margin-bottom: 20px;
    width: 260px;
    margin-right: 30px;
    flex-shrink: 0;
  }

  .facets__heading {
    display: block;
    color: rgba(var(--color-foreground), 0.85);
    font-size: 14px;
    margin-bottom: 15px;
    font-weight: 400;
    letter-spacing: 0.5px;
  }

  .filters-horizontal .facets__heading {
    margin: 0px;
    margin-right: 20px;
    width: unset;
  }

  .filter-section {
    border-top: 1px solid rgba(var(--color-foreground), 0.1);
    margin-right: 0;
  }

  .facets__disclosure-vertical summary {
    padding: 16.5px 17.5px 16.5px 0px;
  }

  .facets__disclosure-vertical details[open] summary .icon-caret {
    transform: rotate(180deg);
  }

  .facets__disclosure-vertical summary .icon-caret {
    position: absolute;
    height: 6px;
    right: 0px;
    top: calc(50% - 2px);
  }

  .facets__display-vertical {
    display: flex;
    flex-direction: column;
    padding: 6px 12px 25px 0px;
  }

  .facet-checkbox {
    padding: 10px 20px 10px 0;
    flex-grow: 1;
    position: relative;
    font-size: 14px;
    display: flex;
    align-items: flex-start;
    word-break: break-word;
    cursor: pointer;
  }

  .facet-checkbox:hover {
    color: rgba(var(--color-foreground), 1);
    text-decoration: underline;
  }

  .facet-checkbox input[type='checkbox'] {
    margin-right: 12px;
    position: absolute;
    opacity: 0;
    width: 16px;
    height: 16px;
    top: 7px;
    left: -4px;
  }

  .facet-checkbox > svg,
  .facet-checkbox > .svg-wrapper {
    background-color: rgb(var(--color-background));
    margin-right: 12px;
    flex-shrink: 0;
  }

  .facet-checkbox .svg-wrapper {
    visibility: hidden;
    position: absolute;
    left: 3px;
    z-index: 5;
    top: 9px;
    width: 11px;
    height: 7px;
  }

  .facet-checkbox > input[type='checkbox']:checked ~ .svg-wrapper > .icon-checkmark {
    visibility: visible;
  }

  .facet-checkbox:has(input:disabled) {
    opacity: 0.4;
    pointer-events: none;
  }

  .filters__show-more {
    background: white;
    border: 1px solid;
    padding: 10px 5px;
    cursor: pointer;
    margin-top: 15px;
    outline: 1px solid transparent;
  }

  .filters__show-more:hover {
    outline: 1px solid black;
  }

  /* STYLES FOR HORIZONTAL FILTERS TYPE */

  .filters-horizontal {
    display: flex;
    flex-wrap: wrap;
    align-items: flex-start;
    max-width: 700px;
  }

  .facets__wrapper {
    position: relative;
    margin-right: 40px;
    margin-bottom: 15px;
  }

  .filter-button {
    width: max-content;
    border: none;
    background: none;
    cursor: pointer;
    font-size: 14px;
    color: rgba(var(--color-foreground), 0.75);
    padding: 0px;
    margin-right: 5px;
  }

  .filter-button:hover {
    text-decoration: underline;
    text-underline-offset: 3px;
    color: rgba(var(--color-foreground), 1);
  }

  .filter-button .icon-caret {
    height: 6px;
    position: relative;
    top: -1px;
    right: -5px;
  }

  .filter-content {
    border-width: var(--popup-border-width);
    border-style: solid;
    border-color: rgba(var(--color-foreground), var(--popup-border-opacity));
    border-radius: var(--popup-corner-radius);
    box-shadow: var(--popup-shadow-horizontal-offset) var(--popup-shadow-vertical-offset) var(--popup-shadow-blur-radius)
      rgba(var(--color-shadow), var(--popup-shadow-opacity));
    background-color: rgb(var(--color-background));
    position: absolute;
    top: calc(100% + 10px);
    left: -12px;
    width: 350px;
    max-height: 550px;
    overflow-y: auto;
    z-index: 5;
  }

  .filter-content .facets__list {
    padding: 7px 20px;
    list-style-type: none;
    margin: 0;
  }

  .facets__head-wrapper {
    border-bottom: 1px solid rgba(var(--color-foreground), 0.2);
    padding: 20px;
    display: flex;
    justify-content: space-between;
    font-size: 14px;
    background-color: rgb(var(--color-background));
    position: sticky;
    top: 0px;
    z-index: 1;
  }

  .facet-reset {
    text-transform: capitalize;
    color: black;
    cursor: pointer;
    text-underline-offset: 3px;
  }

  /* STYLES FOR DRAWER FILTER TYPE */

  .drawer-main-wrapper:not(.drawer-active) .drawer-overlay,
  .drawer-main-wrapper:not(.drawer-active) .drawer__wrapper {
    opacity: 0;
    transition: opacity 0.4s, width 0s linear 0.4s, visibility 0s linear 0.4s;
    visibility: hidden;
    width: 0;
  }

  .drawer__facet-button-trigger {
    border: none;
    background: none;
    display: flex;
    align-items: center;
    padding: 0px;
    margin: 0px;
    cursor: pointer;
  }

  .drawer__facet-button-trigger span {
    margin-left: 10px;
    font-size: 15px;
    color: rgba(var(--color-foreground), 0.75);
  }

  .drawer__facet-button-trigger:hover span {
    text-decoration: underline;
  }

  .facets__header-drawer {
    position: relative;
  }

  .child-facets__header-wrapper {
    border-bottom: 1px solid rgba(var(--color-foreground), 0.08);
    padding: 15px 25px;
    text-align: center;
    display: flex;
    justify-content: center;
    position: sticky;
    top: 0;
    z-index: 2;
  }

  .mobile-facets__heading {
    margin: 0px;
    margin-bottom: 5px;
    font-size: calc(var(--font-heading-scale) * 16px);
  }

  .mobile-facets__count {
    color: rgba(var(--color-foreground), 0.7);
    font-size: 14px;
    margin: 0;
  }

  .drawer-close-icon {
    display: flex;
    align-items: center;
    position: absolute;
    right: 25px;
    top: 50%;
    transform: translate(0%, -50%);
    cursor: pointer;
  }

  .drawer-close-icon .svg-wrapper {
    width: 25px;
    height: 25px;
    position: relative;
    right: -2px;
  }

  .drawer__child-facets-wrapper {
    padding: 30px 25px 15px 25px;
  }

  .mobile-facets__block {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    padding: 17px 0px;
    cursor: pointer;
  }

  .mobile-facets__block span {
    font-size: 16px;
    letter-spacing: 0.6px;
  }

  .drawer__facets-wrapper {
    width: 100%;
    height: 100%;
    position: relative;
  }

  .facets__values-drawer {
    position: absolute;
    right: 0px;
    top: 0px;
    transform: translate(100%);
    background: white;
    width: 100%;
    height: 100%;
    transition: transform 0.3s ease;
    z-index: 10;
  }

  .facets__values-drawer.child-drawer-active {
    transform: translate(0px);
  }

  .mobile-facets__close-button {
    padding: 12px 26px;
    padding-bottom: 20px;
    border: 0px;
    background: none;
    display: flex;
    align-items: center;
    width: 100%;
    margin-top: 20px;
    cursor: pointer;
  }

  .mobile-facets__close-button span {
    margin-left: 10px;
    font-size: 16px;
    letter-spacing: 0.8px;
  }

  .mobile-facets__close-button .svg-wrapper {
    transform: rotate(180deg);
  }

  .filter__values-wrapper {
    padding: 10px 26px;
    overflow-y: scroll;
    height: 100%;
    display: block;
    max-height: calc(100% - 130px);
    padding-bottom: 50px;
  }

  .filter__values-wrapper .facet-checkbox {
    padding: 17px 0px;
    font-size: 16px;
  }

  .filter__values-wrapper .facet-checkbox .svg-wrapper {
    top: 11px;
    transform: translate(0px, 10px);
  }

  .mobile-facets__footer {
    border-top: 1px solid rgba(var(--color-foreground), 0.08);
    padding: 20px;
    bottom: 0;
    position: sticky;
    display: flex;
    z-index: 9;
    margin-top: auto;
    background-color: rgb(var(--color-background));
    background: white;
  }

  .mobile-facets__clear-wrapper {
    align-items: center;
    display: flex;
    justify-content: center;
  }

  .mobile-facets__footer > * {
    width: 50%;
  }

  .mobile-facets__footer button {
    border: none;
    background: black;
    color: white;
    padding: 15px;
    font-size: 16px;
    cursor: pointer;
  }

  .mobile-facets__clear-wrapper a {
    cursor: pointer;
    text-decoration: underline;
    text-underline-offset: 3px;
  }
{%- endstyle -%}

{% if filter_type == 'vertical' %}
  {% assign show_more_number = 10 %}
  <aside class="filters-sidebar small-hide">
    {% liquid
      assign open = true
      if collapse_filters
        assign open = false
      endif
    %}

    <div class="facets__main-head-wrapper">
      <h2 class="facets__heading">Filter:</h2>
    </div>
    {% for f in results.filters %}
      <div
        class="filter-section facets__disclosure-vertical js-filter"
        id="Details-{{ f.param_name | escape }}-{{ section.id }}"
        x-data="{ open: {{ open }} }"
      >
        <details
          x-bind:open="open"
          @toggle="open = $event.target.open"
        >
          <summary>
            <span>
              {{ f.label }}
              {% if f.active_values.size > 0 %}
                ({{ f.active_values.size }})
                <a
                  class="reset-button"
                  data-render-section-url="{{ f.url_to_remove }}"
                  href="{{ f.url_to_remove }}"
                  >reset
                </a>
              {% endif %}
            </span>
            {{ 'icon-caret.svg' | inline_asset_content }}
          </summary>
          <div
            class="facets__display-vertical"
            x-data="{ showMore : $persist(false).as('sm-{{ f.param_name }}') }"
          >
            {% for v in f.values %}
              {% assign input_id = 'Filter-' | append: f.param_name | escape | append: '-' | append: forloop.index %}
              <label
                class="facet-checkbox"
                {% if forloop.index > show_more_number %}
                  x-show="showMore"
                  x-transition
                {% endif %}
              >
                <input
                  id="{{ input_id }}"
                  type="checkbox"
                  name="{{ v.param_name }}"
                  value="{{ v.value }}"
                  data-render-section
                  {% if v.active %}
                    checked
                  {% endif -%}
                  {% if v.count == 0 and v.active == false %}
                    disabled
                  {% endif -%}
                >
                {{- 'icon-square.svg' | inline_asset_content -}}
                <div class="svg-wrapper">
                  {{- 'icon-checkmark.svg' | inline_asset_content -}}
                </div>
                {{- v.label }} ({{ v.count }})
              </label>
            {% endfor %}
            {%- if f.values.size > show_more_number -%}
              <button
                type="button"
                class="filters__show-more"
                x-on:click="showMore = !showMore"
                x-text="showMore ? 'Show less' : 'Show more'"
              >
                Show more
              </button>
            {%- endif %}
          </div>
        </details>
      </div>
    {% endfor %}
  </aside>
{% elsif filter_type == 'horizontal' %}
  <div class="filters-horizontal">
    <h2 class="facets__heading">Filter:</h2>
    {%- for f in results.filters -%}
      <div
        class="facets__wrapper"
        x-data="{ open: false }"
      >
        <button type="button" x-on:click="open = !open" class="filter-button">
          {{ f.label | escape }}
          {{ 'icon-caret.svg' | inline_asset_content }}
        </button>
        <div
          x-cloak
          x-show="open"
          @click.away="open = false"
          x-transition
          class="filter-content js-filter"
          id="Details-{{ f.param_name | escape }}-{{ section.id }}"
        >
          <div class="facets__head-wrapper">
            <span class="facet-name">
              {{ f.label }}
              {% if f.active_values.size > 0 %}
                ({{ f.active_values.size }})
              {% endif %}
            </span>
            {% if f.active_values.size > 0 %}
              <a
                class="facet-reset"
                data-render-section-url="{{ f.url_to_remove }}"
                href="{{ f.url_to_remove }}"
                >reset
              </a>
            {% endif %}
          </div>
          <ul class="facets__list">
            {%- for v in f.values -%}
              {% assign input_id = 'Filter-' | append: f.param_name | escape | append: '-' | append: forloop.index %}
              <li class="facets__item">
                <label class="facet-checkbox">
                  <input
                    type="checkbox"
                    id="{{ input_id }}"
                    name="{{ v.param_name }}"
                    value="{{ v.value }}"
                    data-render-section
                    {% if v.active %}
                      checked
                    {% endif -%}
                    {% if v.count == 0 and v.active == false %}
                      disabled
                    {% endif -%}
                  >
                  {{- 'icon-square.svg' | inline_asset_content -}}
                  <div class="svg-wrapper">
                    {{- 'icon-checkmark.svg' | inline_asset_content -}}
                  </div>
                  {{- v.label }} ({{ v.count }})</label
                >
              </li>
            {%- endfor -%}
          </ul>
        </div>
      </div>
    {% endfor %}
  </div>
{% else %}
  <div
    x-data="{ open: false }"
    class="drawer-main-wrapper js-filter color-{{ section.settings.color_scheme }} {% unless enable_filtering %}large-up-hide{% endunless %}"
    :class="{ 'drawer-active': open }"
    id="Details-{{ f.param_name | escape }}-{{ section.id }}"
  >
    <button type="button" @click="open = !open" class="drawer__facet-button-trigger">
      <div class="svg-wrapper">
        {{ 'icon-filter.svg' | inline_asset_content }}
      </div>
      <div class="desktop-facet-text-wrapper small-hide">
        {%- if enable_filtering -%}
          <span>{{ 'products.facets.filter_button' | t }}</span>
        {%- elsif enable_sorting -%}
          <span>{{ 'products.facets.sort_button' | t }}</span>
        {%- endif -%}
      </div>
      <div class="mobile-facet-text-wrapper medium-hide large-up-hide">
        {%- if enable_filtering and enable_sorting -%}
          <span>{{ 'products.facets.filter_and_sort' | t }}</span>
        {%- elsif enable_filtering -%}
          <span>{{ 'products.facets.filter_button' | t }}</span>
        {%- elsif enable_sorting -%}
          <span>{{ 'products.facets.sort_button' | t }}</span>
        {%- endif -%}
      </div>
    </button>

    <div class="drawer-overlay" @click="open = !open">
      <span hidden>Close</span>
    </div>

    <div class="drawer__wrapper">
      <div class="facets__header-drawer">
        <div class="child-facets__header-wrapper">
          <div class="mobile-facets__header-inner">
            <h2 class="mobile-facets__heading medium-hide large-up-hide">{{ 'products.facets.filter_and_sort' | t }}</h2>
            <h2 class="mobile-facets__heading small-hide">{{ 'products.facets.filter_button' | t }}</h2>
            <p class="mobile-facets__count">
              {%- if collection.products_count == collection.all_products_count -%}
                {{ collection.products_count }} products
              {% else %}
                {{ collection.products_count }} of {{ collection.all_products_count }}
              {% endif %}
            </p>
          </div>
          <div class="drawer-close-icon" @click="open = !open">
            <div class="svg-wrapper">
              {{ 'icon-close.svg' | inline_asset_content }}
            </div>
          </div>
        </div>
      </div>

      <div class="drawer__facets-wrapper" x-data="{ openFilter: $persist(true).as('openFilter') }">
        <div class="drawer__child-facets-wrapper">
          {%- for f in results.filters -%}
            <div class="single-facet__link">
              <div class="mobile-facets__block" @click="openFilter = openFilter === {{ forloop.index }} ? null : {{ forloop.index }}">
                <span>{{ f.label }}</span>
                <span class="mobile-facets__arrow">
                  <div class="svg-wrapper">
                    {{ 'icon-arrow.svg' | inline_asset_content }}
                  </div>
                </span>
              </div>
              <div class="facets__values-drawer" :class="{ 'child-drawer-active': openFilter === {{ forloop.index }} }">
                <button
                  type="button"
                  class="mobile-facets__close-button"
                  @click.stop="openFilter = null"
                >
                  <div class="svg-wrapper">
                    {{ 'icon-arrow.svg' | inline_asset_content }}
                  </div>
                  <span>{{ f.label }}</span>
                </button>
                <div class="filter__values-wrapper">
                  {%- for v in f.values -%}
                    {%- assign input_id = 'Filter-' | append: f.param_name | escape | append: '-' | append: forloop.index -%}
                    <label
                      class="facet-checkbox"
                      {% if forloop.index > show_more_number %}
                        x-show="showMore"
                        x-transition
                      {% endif %}
                    >
                      <input
                        id="{{ input_id }}"
                        type="checkbox"
                        name="{{ v.param_name }}"
                        value="{{ v.value }}"
                        data-render-section
                        {% if v.active %}
                          checked
                        {% endif -%}
                        {% if v.count == 0 and v.active == false %}
                          disabled
                        {% endif -%}
                      >
                      {{- 'icon-square.svg' | inline_asset_content -}}
                      <div class="svg-wrapper">
                        {{- 'icon-checkmark.svg' | inline_asset_content -}}
                      </div>
                      {{- v.label }} ({{ v.count }})
                    </label>
                  {%- endfor -%}
                </div>
                <div class="mobile-facets__footer">
                  <div class="mobile-facets__clear-wrapper">
                    <a
                      class="mobile-facets__clear facet-reset"
                      data-render-section-url="{{ f.url_to_remove }}"
                      href="{{ f.url_to_remove }}"
                      >Reset</a
                    >
                  </div>
                  <button type="button" @click="open = !open">{{ 'products.facets.apply' | t }}</button>
                </div>
              </div>
            </div>
          {%- endfor -%}
        </div>
      </div>

      <div class="mobile-facets__footer">
        <div class="mobile-facets__clear-wrapper">
          <a class="mobile-facets__clear active-filter-clear-all" data-render-section-url="{{ collection.url }}">
            {{- 'products.facets.clear_all' | t -}}
          </a>
        </div>
        <button
          type="button"
          @click="open = !open"
        >
          {{ 'products.facets.apply' | t }}
        </button>
      </div>
    </div>
  </div>
{% endif %}
